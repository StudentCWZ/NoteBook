# Linux 定时任务调度
## crontab 任务调度
### 概述
1. 任务调度概述
    - 任务调度：是指系统在某个时间执行的特定的命令或程序。

2. 任务调度分类
    - 系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等
    - 个别用户工作：个别用户可能希望执行某些程序，比如对 mysql 数据库备份。

3. crontab 基本语法
```
(1) crontab [选项]
```
4. crontab 常用选项

|常用选项|功能|
|:--:|:--:|
|-e|编辑 crontab 定时任务|
|-l|查询 crontab 任务|
|-r|删除当前用户所有的 crontab 任务|

5. crontab 快速入门
```
(1) 设置任务调度文件：/etc/crontab
(2) 设置个人任务调度，执行 crontab -e 命令
(3) 接着输入任务到调度文件
*/1 * * * * ls -l /etc/ >> /tmp/to.txt 命令
(4) 上述的命令：每小时的每分钟执行 ls -l /etc >> /tmp/to.txt 命令
```

### 文件参数
1. /etc/crontab 参数

|项目|含义|范围|
|:--:|:--:|:--:|
|第一个 * |一个小时当中的第几分钟|0 ~ 59|
|第二个 * |一天当中的第几个小时|0 ~ 23|
|第三个 * |一个月当中的第几天|1 ~ 31|
|第四个 * |一年当中的第几月|1 ~ 12|
|第五个 * |一周当中的星期几|0 ~ 7|

### 特殊符号
1. /etc/crontab 特殊符号

|特殊符号|含义|
|:--:|:--:|
|`*`|代表任何时间。比如第一个 `*` 就代表一小时中每分钟都执行一次的意思。|
|,|代表不连续的时间。比如 `0 8,12,16 * * *` 命令，就代表在每天的 8 点 0 分，12 点 0 分，16 点 0 分，16 点 0 分都执行一次命令|
|-|代表连续的时间范围。比如 `0 5 * * 1-6` 命令，代表周一到周六的凌晨 5 点 0 分执行命令|
|`*/n`|代表每隔多久执行一次。比如 `*/10 * * * *` 命令，代表每隔 10 分钟就执行一遍命令|

### 特定时间执行任务案例
1. crontab 任务案例

|时间|含义|
|:--:|:--:|
|`45 22 * * *` 命令|在 22 点 45 分执行命令|
|`0 17 * * 1` 命令|每周一的 17 点 0 分执行命令|
|`0 5 1,5 * *` 命令|每月 1 号和 15 号的凌晨 5 点 0 分执行命令|
|`40 4 * * 1-5` 命令|每周一到周五的凌晨 4 点 40 执行命令|
|`*/10 4 * * *` 命令|每天的凌晨 4 点，每隔十分钟执行一次命令|
|`0 0 1,5 * 1` 命令|每月 1 号和 15 号，每周一的 0 点 0 分都会执行命令|

2. crontab 注意事项
```
(1) 星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱。
```
 
### 应用实例
1. crontab 任务要求
```
(1) 每隔 1 分钟，就将当前的日期信息，追加到 /tmp/mydate 文件中
```
2. crontab 任务步骤
```
(1) 先编写一个文件 /home/mytask1.sh
date >> /tmp/mydate
(2) 给 mytask1.sh 一个可执行权限
(3) crontab -e
(4) */1 * * * * /home/mytask1.sh
(5) 成功
```

### crond 相关指令
1. crond 指令
```
(1) crontab -r # 终止任务调度
(2) crontab -l # 列出当前有哪些任务调度
(3) serive crond restart # 重启任务调度
```
