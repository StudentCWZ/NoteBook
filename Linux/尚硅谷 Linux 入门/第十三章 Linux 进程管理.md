# Linux 进程管理
## 进程的基本介绍
1. 概述
    - 在 Linux 中，每个执行的程序都称为一个进程，每一个进程都分配一个 ID 号。
    - 每一个进程，都会对应一个父进程，而这个父进程可以复制多个子进程。
    - 每个进程都可能以两种方式存在的。前台与后台，所谓前台进程就是用户目前的屏幕上可以操作的。后台进程则是实际在操作，但用于屏幕上无法看到的进程，通常使用后台方式执行。
    - 一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中，直到关机才结束。

## 显示系统执行的进程
### 基本介绍
1. ps 概述
```
(1) ps 命令是用来查看目前系统中，有哪些进程正在执行，以及它们执行状况，可以不加任何选项。
```
2. ps 显示的信息选项

|字段|说明|
|:--:|:--:|
|PID|进程识别号|
|TTY|终端机号|
|TIME|此进程消耗 CPU 时间|
|CMD|正在执行命令或进程名|

3. ps 详细指令
```
(1) ps -a: 显示当前终端的所有进程
(2) ps -u: 以用户的格式显示进程信息
(3) ps -x: 显示后台进程运行的参数
```

### ps 详解
####  ps -aux
1. ps -aux 基本指令
```
(1) ps -aux | grep xxx
```
2. ps -aux 指令说明
```
(1) System V 展示风格
(2) USER: 用户名称
(3) PID: 进程号
(4) %CPU: 进程占用 CPU 的百分比
(5) %MEM: 进程占用物理内存的百分比
(6) %VSZ: 进程占用的虚拟内存大小(单位：KB)
(7) %RSS: 进程占用的物理内存大小(单位：KB)
(8) TT: 终端名称，缩写
(9) STAT: 进程状态，其中 S- 睡眠，s- 表示该进程是会话的先导进程，N- 表示进程拥有比普通优先级耕地的优先级，R- 正在运行，D- 短期等待，Z- 僵死进程，T- 被跟踪或者被停止等等。
(10) STARTED: 进程的启动时间
(11) TIME: CPU 时间，即进程使用 CPU 的总时间
(12) COMMAND: 启动进程所用的命令和参数，如果过长会被截断显示
```

#### ps -ef
1. ps -ef 基本指令
```
(1) ps -ef | grep xxx
(2) ps -ef 是以全格式显示当前所有进程
(3) -e 显示所有进程，-f 全格式
```
2. ps -ef 指令说明
```
(1) 是 BSD 风格
(2) UID: 用户 ID
(3) PID: 进程 ID
(4) PPID: 父进程 ID
(5) C: CPU 用于计算执行优先级因子，数值越大，表明进程是 CPU 密集型运算，执行优先级会降低，数值越小，表明进程是 I/O 密集型运算，执行优先级会提高。
(6) STIME: 进程启动的时间
(7) TTY: 完整的终端名称
(8) TIME: CPU 时间
(9) CMD: 启动进程所用的命令和参数
```

## 终止进程 kill 和 killall
### 介绍
1. kill 概述
```
(1) 若是一个进程执行一半需要停止时，或是已消了很大的系统资源时，此时可以考虑停止该进程。使用 kill 命令来完成此项任务。
```

### 基本语法
1. kill 语法
```
(1) kill [选项] 进程号 (功能描述：通过进程号杀死进程)
(2) killall 进程名称 (功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用)
```

### 常用选项
1. kill 常用选项
```
(1) -9: 表示强迫进程立即停止
```

### 应用实例
1. 踢掉某个非法用户
```
(1) ps -aux | grep sshd
(2) kill pid
```
2. 终止远程登录服务 sshd ，在适当时候再次重启 sshd 服务
```
(1) ps -aux | grep sshd
(2) kill pid
```
3. 终止多个 gedit 编辑器
```
(1) killall gedit
```
4. 强制杀掉一个终端
```
(1) ps -aux | grep bash
(2) kill -9 pid
```

## 查看进程树 pstree
### 基本语法
1. pstree 指令
```
(1) pstree [选项] # 可以更加直观的来看进程信息
```

### 常用选项
1. pstree 常用选项
```
(1) -p: 显示进程的 PID
(2) -u: 显示进程的所属用户
```

### 应用实例
1. 树状的形式显示进程的 pid
```
(1) pstree -p
```
2. 树状的形式显示进程的用户 id
```
(1) pstree -u
```

## 动态监控进程
### 基本介绍
1. 概述
```
(1) top 与 ps 命令很相似，它们都用来显示正在执行的进程。
(2) top 与 ps 最大的不同之处，在于 top 在执行一段时间可以更新正在运行的进程。
```

### 基本语法
1. top 指令
```
(1) top [选项]
```

### 选项说明
1. top 选项

|选项|功能|
|:--:|:--:|
|-d 秒数|指定 top 命令每隔几秒更新，默认是 3 秒在 top 命令的交互模式当中可以执行的命令|
|-i|使 top 不显示任何闲置或者僵死进程|
|-p|通过指定监控进程 ID 来仅仅监控某个进程的状态|

### 交互操作说明
1. top 交互操作

|操作|功能|
|:--:|:--:|
|P|以 CPU 使用率排序，默认就是此项|
|M|以内存的使用率排序|
|N|以 PID 排序|
|q|退出 top |

### 应用实例
1. 监视特定用户
```
(1) top: 输入此命令，按回车键，查看执行的进程。
(2) u: 然后输入 u 回车，再输入用户名，即可。
```
2. 终止指定的进程
```
(1) top: 输入此命令，按回车键，查看执行的进程。
(2) k: 然后输入 k 回车，再输入要结束的进程 ID 号。
```
3. 指定系统状态更新的时间：每隔10秒自动更新
```
(1) top -d 10
```

## 监控网络状态
### 基本语法
1. netstat 指令
```
(1) netstat [选项]
```

### 选项说明
1. netstat 选项
```
(1) -an 按一定顺序排列输出
(2) -p 显示哪个进程在调用
```

### 检测主机连接命令
1. 概述
```
(1) ping 是一种网络检测工具，它主要使用检测远程主机是否正常，或是两部主机间的介质是否为断、网线是否脱落或故障。
```
